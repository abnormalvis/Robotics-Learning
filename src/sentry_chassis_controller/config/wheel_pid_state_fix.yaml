wheel_pid_controller:
  # Controller type
  type: "sentry_chassis_controller/WheelPidController"

  # Physical defaults
  wheel_track: 0.36
  wheel_base: 0.36

  # STATE REPORTING FIX: Ensure joint states are properly read from hardware
  joint_state_controller:
    publish_rate: 10  # Match forward kinematics rate

  # PID Parameters for steering pivot (use URDF names!!!)
  pivot:
    p: 1.3      # 从1.5降至1.3，降低比例过快
    i: 0.02     # 从0.05降低60%，极保守积
    d: 0.25     # 从0.15增至0.25，增强预测性
    i_clamp: 0.3  # 从0.5收紧，防止积分饱和
    output_min: -5.0
    output_max: 5.0

  # PID Parameters for wheel drive
  wheel:
    p: 0.7      # 从1.0再降30%，根本降低灵敏度
    i: 0.05     # 从0.1减半，让积分更保守
    d: 0.2      # 从0.1倍增，强化振荡抑制
    i_clamp: 0.2  # 从0.3继续收紧
    antiwindup: 0.0

  # Ensure controller reads actual joint states - use REAL URDF NAMES!!!
  # This is the key fix - the controller must report actual joint positions
  enable_state_feedback: true
  joint_names_reported:
    - left_front_wheel_joint
    - right_front_wheel_joint
    - left_back_wheel_joint
    - right_back_wheel_joint
    - left_front_pivot_joint
    - right_front_pivot_joint
    - left_back_pivot_joint
    - right_back_pivot_joint

  # Per-wheel PID configurations
  wheels:
    # Wheel drive PID settings (using symbolic names from config)
    wheel_fl:
      p: 0.7      # 从1.0再降30%，根本降低灵敏度
      i: 0.05     # 从0.1减半，让积分更保守
      d: 0.2      # 从0.1倍增，强化振荡抑制
      i_clamp: 0.2  # 从0.3继续收紧
      output_min: -10.0
      output_max: 10.0
    wheel_fr:
      p: 0.7      # 从1.0再降30%，根本降低灵敏度
      i: 0.05     # 从0.1减半，让积分更保守
      d: 0.2      # 从0.1倍增，强化振荡抑制
      i_clamp: 0.2  # 从0.3继续收紧
      output_min: -10.0
      output_max: 10.0
    wheel_rl:
      p: 0.7      # 从1.0再降30%，根本降低灵敏度
      i: 0.05     # 从0.1减半，让积分更保守
      d: 0.2      # 从0.1倍增，强化振荡抑制
      i_clamp: 0.2  # 从0.3继续收紧
      output_min: -10.0
      output_max: 10.0
    wheel_rr:
      p: 0.7      # 从1.0再降30%，根本降低灵敏度
      i: 0.05     # 从0.1减半，让积分更保守
      d: 0.2      # 从0.1倍增，强化振荡抑制
      i_clamp: 0.2  # 从0.3继续收紧
      output_min: -10.0
      output_max: 10.0

    # Pivot steering PID settings
    pivot_fl:
      p: 1.3      # 从1.5降至1.3，降低比例过快
      i: 0.02     # 从0.05降低60%，极保守积
      d: 0.25     # 从0.15增至0.25，增强预测性
      i_clamp: 0.3  # 从0.5收紧，防止积分饱和
      output_min: -5.0
      output_max: 5.0
      
    pivot_fr:
      p: 1.3      # 从1.5降至1.3，降低比例过快
      i: 0.02     # 从0.05降低60%，极保守积
      d: 0.25     # 从0.15增至0.25，增强预测性
      i_clamp: 0.3  # 从0.5收紧，防止积分饱和
      output_min: -5.0
      output_max: 5.0
    pivot_rl:
      p: 1.3      # 从1.5降至1.3，降低比例过快
      i: 0.02
      d: 0.15
      i_clamp: 1.0
      output_min: -5.0
      output_max: 5.0
    pivot_rr:
      p: 1.3      # 从1.5降至1.3，降低比例过快
      i: 0.02
      d: 0.25
      i_clamp: 0.3
      output_min: -5.0
      output_max: 5.0