# 前馈控制与前馈PID

前馈控制（Feedforward Control）是一类**基于系统模型和期望输入，提前计算控制量以抵消可测扰动或跟踪参考轨迹**的控制方法。与反馈控制（如PID）不同，前馈控制不依赖误差信号，而是利用对系统的先验知识"预判"需要的控制量。

在机器人、伺服系统、化工过程等领域，**前馈+反馈（Feedforward + Feedback）**的组合架构是工程实践的标准配置：

- **前馈**：提供主要的控制量，快速、精确地跟踪参考或补偿已知扰动
- **反馈（PID等）**：修正模型误差、未知扰动、测量噪声引起的剩余误差

核心思想可以总结为：

> **前馈解决"已知的部分"，反馈解决"未知的部分"。**

下面按"基本原理 → 前馈设计方法 → 前馈+PID组合 → 工程实现 → 调参经验 → 实际案例"展开。

---

## 1. 核心概念：前馈 vs 反馈

### 1.1 反馈控制（Feedback Control）

**原理**：测量输出 $y$，与参考 $r$ 比较得到误差 $e=r-y$，根据误差计算控制量 $u$。

**优点**：

- 不需要精确模型
- 自动抵消未知扰动
- 鲁棒性强

**缺点**：

- **必须等误差出现才能修正**（滞后性）
- 对快速变化的参考跟踪滞后
- 对大扰动响应慢（需要积分时间累积）

**典型例子**：PID 控制器

$$
u(t) = K_p e(t) + K_i\int e(\tau)d\tau + K_d\frac{de(t)}{dt}
$$

### 1.2 前馈控制（Feedforward Control）

**原理**：根据参考 $r$ 和系统模型，**直接计算**理想情况下需要的控制量 $u_{ff}$，不依赖误差。

**优点**：

- **零滞后**：不需要等误差出现
- 快速跟踪：对快速变化的参考响应迅速
- 主动补偿：可以提前抵消可测扰动（例如已知的负载变化）

**缺点**：

- **依赖模型**：模型不准导致前馈不准
- **无法抵消未知扰动**：只能处理"已知的部分"
- 没有反馈，系统开环不稳定时无法使用

**典型例子**：

对于一个质量 $m$ 的物体，要跟踪加速度 $a_{ref}$，根据牛顿第二定律：

$$
u_{ff} = m \cdot a_{ref}
$$

这就是前馈控制量。

### 1.3 前馈+反馈组合（最常用架构）

$$
u(t) = u_{ff}(t) + u_{fb}(t)
$$

- $u_{ff}$：根据参考和模型计算（前馈）
- $u_{fb}$：根据误差计算（反馈，例如PID）

**信号流**：

```
参考 r --> 前馈控制器 --> u_ff --+
                                    +--> u --> 系统 --> 输出 y
          误差 e <-- 反馈 <-- y      |
             |                      |
             +--> PID --> u_fb -----+
```

这种架构结合了两者的优点：

- 前馈提供"大部分"控制量，快速跟踪
- 反馈修正"剩余误差"，增强鲁棒性

---

## 2. 前馈控制的数学原理

### 2.1 理想前馈：逆模型

考虑系统：

$$
y = G(s) \cdot u
$$

其中 $G(s)$ 是传递函数。

如果我们希望输出 $y$ 跟踪参考 $r$，理想情况下：

$$
r = G(s) \cdot u_{ff}
$$

解出：

$$
u_{ff} = G^{-1}(s) \cdot r
$$

这就是**逆模型前馈**（Inverse Model Feedforward）。

**例子：一阶惯性系统**

系统：

$$
G(s) = \frac{K}{\tau s + 1}
$$

逆模型：

$$
G^{-1}(s) = \frac{\tau s + 1}{K}
$$

前馈控制律：

$$
u_{ff}(t) = \frac{1}{K}\left(r(t) + \tau\dot{r}(t)\right)
$$

- $\frac{1}{K}r(t)$：稳态项（比例前馈）
- $\frac{\tau}{K}\dot{r}(t)$：动态项（微分前馈）

### 2.2 前馈的局限：模型不确定性

如果实际系统是 $G_{real}(s)$，但前馈用的是 $G_{model}(s)$，则：

$$
y = G_{real}(s) \cdot G_{model}^{-1}(s) \cdot r
$$

只有当 $G_{real} = G_{model}$ 时，$y=r$（完美跟踪）。

否则会有**前馈误差**：

$$
e_{ff} = r - y = \left(1 - \frac{G_{real}}{G_{model}}\right) \cdot r
$$

这就是为什么需要**反馈修正**。

---

## 3. 前馈设计的三种常见方法

### 3.1 方法 1：基于物理模型（最推荐）

**步骤**：

1. 根据系统的物理方程（牛顿定律、电路方程、流体力学等）建立模型
2. 根据期望的输出 $r$ 和导数 $\dot{r}, \ddot{r}$ 反推所需的输入 $u_{ff}$

**例子：电机速度控制**

假设电机动力学（忽略电感）：

$$
J\dot{\omega} = K_t i - b\omega - \tau_{load}
$$

- $J$：转动惯量
- $\omega$：角速度
- $K_t$：力矩常数
- $i$：电流（控制量）
- $b$：粘滞摩擦系数
- $\tau_{load}$：负载力矩

要跟踪 $\omega_{ref}$，前馈电流：

$$
i_{ff} = \frac{1}{K_t}\left(J\dot{\omega}_{ref} + b\omega_{ref} + \tau_{load,est}\right)
$$

- $J\dot{\omega}_{ref}$：加速度项（动态补偿）
- $b\omega_{ref}$：摩擦补偿（稳态项）
- $\tau_{load,est}$：已知负载补偿

### 3.2 方法 2：传递函数逆模型

**步骤**：

1. 辨识系统传递函数 $G(s)$（例如通过阶跃响应、频域辨识）
2. 计算逆模型 $G^{-1}(s)$
3. 实现前馈控制器 $u_{ff} = G^{-1}(s) \cdot r$

**注意事项**：

- $G^{-1}(s)$ 可能**不可实现**（例如相对阶大于0时，逆模型包含微分器，噪声敏感）
- 解决办法：
	- 只逆低频部分（忽略高频动态）
	- 增加低通滤波器限制带宽

**例子：带低通滤波的逆模型**

如果 $G(s) = \frac{1}{s^2+2\zeta\omega_n s+\omega_n^2}$（二阶系统），逆模型是：

$$
G^{-1}(s) = s^2+2\zeta\omega_n s+\omega_n^2
$$

但 $s^2$ 是二阶微分，噪声极敏感。可以用：

$$
G_{ff}(s) = \frac{s^2+2\zeta\omega_n s+\omega_n^2}{(\tau s+1)^2}
$$

其中 $\tau$ 是滤波时间常数（根据噪声水平选择）。

### 3.3 方法 3：基于数据的学习前馈

**步骤**：

1. 记录大量"参考 $r(t)$ → 实际所需控制 $u(t)$"的数据
2. 用机器学习（神经网络、高斯过程）拟合 $u_{ff} = f(r, \dot{r}, \ddot{r})$
3. 在线查表或推理

**适用场景**：

- 系统复杂，物理建模困难（例如液压系统、软体机器人）
- 有大量历史数据
- 计算资源充足

---

## 4. 前馈 + PID 组合架构

### 4.1 标准结构

$$
u(t) = u_{ff}(t) + u_{pid}(t)
$$

其中：

- $u_{ff}(t)$：前馈项（根据参考计算）
- $u_{pid}(t) = K_p e + K_i\int e\,dt + K_d\dot{e}$：反馈项（根据误差计算）

**调参顺序**（推荐）：

1. **先调前馈**：
	- 断开反馈（设 $K_p=K_i=K_d=0$）
	- 只用前馈跟踪参考，观察误差
	- 调整前馈参数（模型参数、增益等）使误差尽量小

2. **再调反馈**：
	- 开启反馈（从小的 $K_p$ 开始）
	- 用反馈修正剩余误差
	- 由于前馈已经提供了主要控制量，反馈增益可以比纯PID小很多

### 4.2 为什么组合后反馈增益更小？

纯PID时，所有控制量都靠误差积分/比例产生，需要较大的 $K_p,K_i$。

加入前馈后，大部分控制量由前馈提供，误差本身就很小，反馈只需要"微调"，因此：

- $K_p$ 可以更小（减少过冲、振荡）
- $K_i$ 可以更小（减少积分饱和）
- $K_d$ 可以更小（减少噪声放大）

**工程效果**：

- 更快的响应（前馈零滞后）
- 更小的超调（反馈增益小）
- 更好的抗扰性（反馈自动修正）

---

## 5. 不同类型的前馈

### 5.1 参考前馈（Reference Feedforward）

**目标**：跟踪时变参考 $r(t)$。

**控制律**：

$$
u_{ff}(t) = f(r(t), \dot{r}(t), \ddot{r}(t))
$$

**例子**：

- 机械臂关节跟踪轨迹：$u_{ff} = M(q)\ddot{q}_{ref} + C(q,\dot{q})\dot{q}_{ref} + G(q)$（逆动力学）
- 移动底盘速度跟踪：$u_{ff} = \frac{m}{b}\dot{v}_{ref} + v_{ref}$

### 5.2 扰动前馈（Disturbance Feedforward）

**目标**：补偿可测扰动 $d(t)$。

**控制律**：

$$
u_{ff}(t) = -G_d^{-1}(s) \cdot d(t)
$$

其中 $G_d(s)$ 是扰动到输出的传递函数。

**例子**：

- 风力补偿：无人机测量风速 $v_{wind}$，前馈补偿 $u_{ff} = k_{wind} \cdot v_{wind}$
- 负载补偿：机械臂末端力传感器测 $F_{ext}$，前馈 $\tau_{ff} = J^\top F_{ext}$

### 5.3 速度/加速度前馈（Velocity/Acceleration Feedforward）

对于位置伺服系统，常见的前馈形式：

$$
u_{ff} = K_{vff}\dot{r} + K_{aff}\ddot{r}
$$

- $K_{vff}$：速度前馈增益（补偿粘滞摩擦、反电动势）
- $K_{aff}$：加速度前馈增益（补偿惯性）

**调参经验**：

- $K_{vff}$：对应系统的阻尼/摩擦系数
- $K_{aff}$：对应系统的惯量/质量

可以通过实验辨识：

1. 给定恒定速度 $\dot{r}=v_0$，测量稳态控制量 $u_{ss}$ → $K_{vff} = u_{ss}/v_0$
2. 给定恒定加速度 $\ddot{r}=a_0$，测量瞬时控制量变化 → $K_{aff} = \Delta u/a_0$

---

## 6. 工程实现：离散时间下的前馈+PID

### 6.1 控制循环结构

```text
given: Ts (sampling period), model parameters (m, b, K_vff, K_aff, ...)
       PID gains (Kp, Ki, Kd)

initialize: e_integral = 0, e_prev = 0

loop every Ts:
	# 1. 获取参考及其导数
	r = get_reference()
	r_dot = compute_derivative(r, r_prev, Ts)  # or from trajectory planner
	r_ddot = compute_derivative(r_dot, r_dot_prev, Ts)
	
	# 2. 前馈控制量
	u_ff = K_vff * r_dot + K_aff * r_ddot
	# (或更复杂的物理模型前馈)
	
	# 3. 测量输出
	y = measure_output()
	
	# 4. 反馈控制量 (PID)
	e = r - y
	e_integral += e * Ts
	e_integral = clamp(e_integral, -integral_limit, integral_limit)
	e_derivative = (e - e_prev) / Ts
	
	u_fb = Kp * e + Ki * e_integral + Kd * e_derivative
	
	# 5. 总控制量
	u = u_ff + u_fb
	u = clamp(u, u_min, u_max)
	
	# 6. 应用控制
	apply_control(u)
	
	# 7. 更新状态
	e_prev = e
	r_prev = r
	r_dot_prev = r_dot
```

### 6.2 导数计算的注意事项

**问题**：数值微分对噪声极敏感。

**解决办法**：

1. **用轨迹规划器直接给出导数**（推荐）
	- 例如五次多项式轨迹、B样条轨迹，可以解析计算 $\dot{r}, \ddot{r}$

2. **低通滤波 + 差分**
	```python
	r_dot_raw = (r - r_prev) / Ts
	r_dot = alpha * r_dot_raw + (1 - alpha) * r_dot_prev  # 指数滤波
	```

3. **用状态观测器估计导数**
	- 例如 Luenberger 观测器、卡尔曼滤波器

---

## 7. 调参指南

### 7.1 前馈参数调参

**步骤 1：断开反馈，只用前馈**

设 $K_p=K_i=K_d=0$，只用 $u=u_{ff}$。

**步骤 2：给定参考，观察跟踪效果**

- 阶跃响应：观察是否有稳态误差
- 斜坡响应：观察是否有跟踪滞后
- 正弦响应：观察幅值和相位误差

**步骤 3：调整前馈参数**

- 如果稳态误差大：增大稳态前馈项（$K_{vff}$ 或比例项）
- 如果动态滞后大：增大动态前馈项（$K_{aff}$ 或微分项）
- 如果幅值过大/过小：调整总增益

**典型调参过程（电机速度控制）**：

1. 给定恒速参考 $\omega_{ref}=100$ rpm，测稳态控制电压 $u_{ss}=2.5$ V
	→ $K_{vff} = 2.5/100 = 0.025$ V/rpm

2. 给定加速 $\dot{\omega}_{ref}=500$ rpm/s，测瞬时控制增量 $\Delta u=1.0$ V
	→ $K_{aff} = 1.0/500 = 0.002$ V/(rpm/s)

3. 用这些参数做前馈，观察误差 → 微调

### 7.2 反馈（PID）参数调参

**前提**：前馈已经调好，误差已经很小。

**步骤**：

1. 从小的 $K_p$ 开始（例如原来纯PID的 1/5）
2. 观察误差是否收敛、是否振荡
3. 适当增加 $K_i$ 消除剩余稳态误差（可以比纯PID小很多）
4. 适当增加 $K_d$ 加快动态响应（但要小心噪声）

**经验**：

- 如果前馈准确，反馈增益通常可以比纯PID小 **3~10 倍**
- 反馈主要作用是"兜底"和抗扰，不需要承担主要跟踪任务

---

## 8. 前馈控制的常见误区与坑

### 8.1 误区 1："前馈不需要反馈"

**错误！**前馈只能处理"已知的部分"（模型+参考），无法抵消：

- 模型误差（参数不准）
- 未知扰动（突然的负载变化、风、碰撞）
- 测量噪声

没有反馈的纯前馈是**开环控制**，系统必须非常准确且扰动极小才能用。

### 8.2 误区 2："前馈越大越好"

如果前馈增益过大（模型参数高估），会导致：

- 超调（过度补偿）
- 反馈需要"反向修正"（浪费控制量、可能振荡）

正确做法：前馈应该"刚刚好"，让反馈修正量接近零。

### 8.3 坑 1：导数噪声

数值微分放大噪声，导致 $\ddot{r}$ 抖动 → 前馈控制量抖动 → 执行器抖动/磨损。

**解决办法**：

- 用轨迹规划器提供平滑的 $\dot{r}, \ddot{r}$
- 低通滤波
- 限制前馈加速度项的幅值

### 8.4 坑 2：执行器饱和

前馈计算的 $u_{ff}$ 可能超出执行器范围（例如电机电压饱和）。

如果直接饱和，会导致：

- 实际输入不等于期望输入 → 前馈失效
- 反馈积分饱和（积分项继续累积但控制量已饱和）

**解决办法**：

- 限制前馈输出：`u_ff = clamp(u_ff, u_min, u_max)`
- 抗积分饱和（Anti-windup）：当总控制量饱和时，停止积分累积
- 轨迹规划时考虑执行器限制（例如限制最大加速度）

---

## 9. 实际案例

### 9.1 案例 1：机械臂关节位置控制

**系统**：单关节机械臂，动力学：

$$
J\ddot{q} + b\dot{q} + mgl\sin(q) = \tau
$$

**简化（小角度）**：

$$
J\ddot{q} + b\dot{q} + k_g q = \tau
$$

其中 $k_g = mgl$（重力刚度）。

**前馈设计**：

要跟踪 $q_{ref}(t)$，理想力矩：

$$
\tau_{ff} = J\ddot{q}_{ref} + b\dot{q}_{ref} + k_g q_{ref}
$$

**反馈（PID）**：

$$
\tau_{fb} = K_p(q_{ref}-q) + K_i\int(q_{ref}-q)dt + K_d(\dot{q}_{ref}-\dot{q})
$$

**总控制**：

$$
\tau = \tau_{ff} + \tau_{fb}
$$

**调参经验**：

- $J, b, k_g$ 可以通过 CAD 模型或实验辨识
- 前馈准确后，$K_p$ 可以比纯PID小 5~10 倍
- $K_i$ 用来消除重力补偿误差（如果 $k_g$ 不准）

### 9.2 案例 2：移动底盘速度控制（麦轮/全向）

**系统**：底盘 $x$ 方向速度动力学（简化）：

$$
m\dot{v}_x + bv_x = F_x
$$

**前馈设计**：

要跟踪 $v_{x,ref}$：

$$
F_{x,ff} = m\dot{v}_{x,ref} + bv_{x,ref}
$$

**反馈（PI）**：

$$
F_{x,fb} = K_p(v_{x,ref}-v_x) + K_i\int(v_{x,ref}-v_x)dt
$$

**总控制**：

$$
F_x = F_{x,ff} + F_{x,fb}
$$

**Python 实现**：

```python
import numpy as np
import matplotlib.pyplot as plt

# 系统参数
m = 10.0  # kg
b = 2.0   # 阻尼系数

# 采样周期
Ts = 0.01

# 离散化（欧拉法）
A = 1 - b*Ts/m
B = Ts/m

# 前馈参数
K_vff = b
K_aff = m

# PID 参数（因为有前馈，可以很小）
Kp = 0.5
Ki = 0.1

# 仿真
v_x = 0.0
e_integral = 0.0
sim_steps = 500
t = 0
v_hist = []
v_ref_hist = []
u_hist = []

for step in range(sim_steps):
    # 参考轨迹（正弦变化速度）
    v_ref = 2.0 * np.sin(2*np.pi*0.2*t)
    v_ref_dot = 2.0 * 2*np.pi*0.2 * np.cos(2*np.pi*0.2*t)
    
    # 前馈
    u_ff = K_vff * v_ref + K_aff * v_ref_dot
    
    # 反馈
    e = v_ref - v_x
    e_integral += e * Ts
    u_fb = Kp * e + Ki * e_integral
    
    # 总控制
    u = u_ff + u_fb
    
    # 应用控制（模拟系统）
    v_x = A * v_x + B * u
    
    # 记录
    v_hist.append(v_x)
    v_ref_hist.append(v_ref)
    u_hist.append(u)
    t += Ts

# 绘图
plt.figure(figsize=(10, 6))
plt.subplot(2, 1, 1)
plt.plot(v_ref_hist, 'r--', label='v_ref')
plt.plot(v_hist, 'b-', label='v_x')
plt.legend()
plt.grid()
plt.title('Feedforward + PID Velocity Control')
plt.ylabel('Velocity (m/s)')

plt.subplot(2, 1, 2)
plt.plot(u_hist, label='Control Force')
plt.legend()
plt.grid()
plt.xlabel('Time step')
plt.ylabel('Force (N)')
plt.tight_layout()
plt.show()
```

**对比实验**：

- 只用 PID（$u=u_{fb}$）：需要 $K_p=5, K_i=1$ 才能跟踪，有明显滞后
- 前馈+PID（$u=u_{ff}+u_{fb}$）：$K_p=0.5, K_i=0.1$ 就够，几乎无滞后

### 9.3 案例 3：四旋翼姿态控制（前馈 + PID）

**系统**：四旋翼俯仰角 $\theta$ 动力学（简化）：

$$
I_y\ddot{\theta} = \tau_y
$$

**前馈**：

$$
\tau_{y,ff} = I_y\ddot{\theta}_{ref}
$$

**反馈（PD）**：

$$
\tau_{y,fb} = K_p(\theta_{ref}-\theta) + K_d(\dot{\theta}_{ref}-\dot{\theta})
$$

**调参经验**：

- $I_y$ 可以从 CAD 模型获取（误差 $\pm 20\%$ 也能接受）
- 前馈准确后，$K_p, K_d$ 可以比纯PD小 3~5 倍
- 减少超调、更平滑

---

## 10. 高级话题

### 10.1 自适应前馈（Adaptive Feedforward）

**问题**：系统参数变化（例如负载变化、温度漂移），前馈模型不准。

**解决办法**：在线估计参数，更新前馈模型。

**例子**：

电机转动惯量 $J$ 随负载变化，可以用递推最小二乘（RLS）在线估计：

$$
\hat{J}_k = \hat{J}_{k-1} + \text{correction based on tracking error}
$$

更新前馈：

$$
u_{ff,k} = \hat{J}_k \cdot \ddot{\omega}_{ref}
$$

### 10.2 迭代学习控制（Iterative Learning Control, ILC）

**场景**：重复执行相同轨迹（例如工业机械臂重复焊接）。

**方法**：每次执行后，根据跟踪误差更新前馈：

$$
u_{ff}^{(i+1)}(t) = u_{ff}^{(i)}(t) + L \cdot e^{(i)}(t)
$$

其中 $L$ 是学习增益，$e^{(i)}(t)$ 是第 $i$ 次的误差。

经过多次迭代，前馈逐渐"学会"完美跟踪。

### 10.3 基于模型的前馈 + MPC

MPC 本身包含了前馈思想（基于模型预测未来控制）。

可以把 MPC 和传统前馈结合：

- 用前馈提供"粗略"控制
- 用 MPC 优化"精细"控制 + 处理约束

---

## 11. 前馈控制的工程检查清单

### 设计阶段

- [ ] 系统模型是否足够准确？（物理模型 or 辨识）
- [ ] 参考轨迹是否平滑？（是否有 $\dot{r}, \ddot{r}$？）
- [ ] 前馈是否可实现？（是否需要微分？噪声敏感？）
- [ ] 执行器是否有足够余量？（前馈+反馈总和是否超限？）

### 调试阶段

- [ ] 先断开反馈，只用前馈，观察误差大小
- [ ] 前馈参数是否合理？（稳态 + 动态分别检查）
- [ ] 导数计算是否稳定？（是否有滤波？）
- [ ] 加上反馈后，反馈量是否很小？（如果反馈很大，说明前馈不准）

### 运行阶段

- [ ] 监控前馈和反馈的比例（应该是前馈为主）
- [ ] 监控执行器饱和频率（频繁饱和说明轨迹/参数不合理）
- [ ] 监控跟踪误差（应该比纯反馈小很多）

---

## 12. 总结与建议

### 核心要点

1. **前馈的本质**：利用模型和参考"提前计算"控制量，零滞后
2. **前馈的优势**：快速跟踪、主动补偿、减轻反馈负担
3. **前馈的局限**：依赖模型、无法抗未知扰动、需要平滑参考
4. **最佳实践**：前馈+反馈组合，前馈提供主要控制，反馈修正误差

### 与其他方法的关系

| 方法             | 适用场景                | 与前馈的关系          |
| -------------- | ------------------- | --------------- |
| **PID**        | 反馈控制，模型不清楚          | 可以组合（前馈+PID）   |
| **LQR**        | 线性系统最优反馈            | 可以加前馈（$u_{ff}$） |
| **MPC**        | 约束优化、预测控制           | MPC本身包含前馈思想    |
| **ADRC**       | 扰动估计+补偿             | ESO可看作"自适应前馈"  |
| **逆动力学控制（IDC）** | 机械臂、机器人（非线性系统前馈）    | 本质是前馈（逆模型）      |

### 学习路线

1. **理解前馈原理**：逆模型、物理模型
2. **简单实验**：一阶系统（电机速度）试前馈
3. **组合反馈**：前馈+PID，对比纯PID
4. **复杂系统**：机械臂逆动力学、移动机器人轨迹跟踪
5. **进阶**：自适应前馈、ILC、学习型前馈

### 何时使用前馈？

**强烈推荐**：

- 需要快速跟踪时变参考（轨迹跟踪、高速运动）
- 系统模型比较准确（可以实验辨识）
- 有可测扰动（负载、风力、已知外力）

**可选**：

- 系统慢、反馈够用（化工过程）
- 模型很不准（此时前馈效果有限）

**不推荐**：

- 系统开环不稳定且模型极不准（前馈可能帮倒忙）
- 参考信号噪声大、不平滑（导数无法计算）

---

## 13. 参考资料

- **经典教材**：
	- *Feedback Control of Dynamic Systems* by Franklin, Powell, Emami-Naeini（第8章：前馈控制）
	- *Modern Control Engineering* by Ogata（第9章）
- **机器人相关**：
	- *Robot Modeling and Control* by Spong, Hutchinson, Vidyasagar（第11章：计算力矩控制 = 前馈）
	- *Springer Handbook of Robotics*（轨迹跟踪章节）
- **工业应用**：
	- 伺服系统手册（Siemens, Bosch Rexroth）：速度/加速度前馈调参指南

---

## 14. 附录：常用前馈公式速查

### 一阶系统

$$
G(s) = \frac{K}{\tau s + 1}
$$

前馈：

$$
u_{ff} = \frac{1}{K}(r + \tau\dot{r})
$$

### 二阶系统（质量-弹簧-阻尼）

$$
m\ddot{y} + b\dot{y} + ky = u
$$

前馈：

$$
u_{ff} = m\ddot{r} + b\dot{r} + kr
$$

### 电机速度控制

$$
J\dot{\omega} + b\omega = K_t i
$$

前馈电流：

$$
i_{ff} = \frac{1}{K_t}(J\dot{\omega}_{ref} + b\omega_{ref})
$$

### 机械臂逆动力学（单关节）

$$
J\ddot{q} + b\dot{q} + mgl\sin q = \tau
$$

前馈力矩：

$$
\tau_{ff} = J\ddot{q}_{ref} + b\dot{q}_{ref} + mgl\sin q_{ref}
$$

---

**如果你想针对具体系统（底盘、云台、机械臂）写一套前馈+PID的完整调参流程和代码，随时告诉我！**
